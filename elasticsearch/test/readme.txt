commands:

./run.sh node{1,2,3...}

add stuff/indices:

## index twitter (autogenerated if not existing), mapping type _doc (deprecated):

# mapping types are deprecated; see https://www.elastic.co/guide/en/elasticsearch/reference/current/removal-of-types.html
# recommended in 6.x is to always use type name _doc

curl -XPUT -H 'Content-Type: application/json' 'http://localhost:9200/twitter/_doc/kimchy' -d '{ "name" : "Shay Banon" }'

# autogenerated document ID
curl -XPOST -H 'Content-Type: application/json' 'http://localhost:9200/twitter/_doc' -d '{ "name" : "Elon Musk" }'
= {"_index":"twitter","_type":"_doc","_id":"nskNjmgBpfl8Zi7pGZxG","_version":1,"result":"created","_shards":{"total":2,"successful":1,"failed":0},"_seq_no":0,"_primary_term":1}ubuntu@devbox:~/doc/mydocs/pub/elasticsearch/test$

$ curl -XPOST -H 'Content-Type: application/json' 'http://localhost:9200/twitter/_doc' -d '{ "name" : "Donald Trump" }'
{"_index":"twitter","_type":"_doc","_id":"n8kNjmgBpfl8Zi7pOJyi","_version":1,"result":"created","_shards":{"total":2,"successful":1,"failed":0},"_seq_no":1,"_primary_term":1}ubuntu@devbox:~/doc/mydocs/pub/elasticsearch/test$
$

# custom "type" field (no special meaning)
$ curl -XPOST -H 'Content-Type: application/json' 'http://localhost:9200/twitter/_doc' -d '
{
    "type": "tweet",    
    "user": "kimchy", 
    "postDate": "2009-11-15T13:12:00", 
    "message": "Trying out Elastic Search, so far so good?" 
}'

=> {"_index":"twitter","_type":"_doc","_id":"oMkQjmgBpfl8Zi7pzJxy","_version":1,"result":"created","_shards":{"total":2,"successful":1,"failed":0},"_seq_no":0,"_primary_term":1}ubuntu@devbox:~/doc/mydocs/pub/elasticsearch/test$


curl -XPOST -H 'Content-Type: application/json' 'http://localhost:9200/twitter/_doc' -d '
{ 
    "type": "tweet",    
    "user": "kimchy", 
    "postDate": "2009-11-15T14:12:12", 
    "message": "Another tweet, will it be indexed?" 
}'

=> {"_index":"twitter","_type":"_doc","_id":"ockRjmgBpfl8Zi7pApyr","_version":1,"result":"created","_shards":{"total":2,"successful":1,"failed":0},"_seq_no":1,"_primary_term":1}ubuntu@devbox:~/doc/mydocs/pub/elasticsearch/test$

etc.

GET them back by ID:

$ curl 'http://localhost:9200/twitter/_doc/oMkQjmgBpfl8Zi7pzJxy' | jq
{
  "_index": "twitter",
  "_type": "_doc",
  "_id": "oMkQjmgBpfl8Zi7pzJxy",
  "_version": 1,
  "found": true,
  "_source": {
    "type": "tweet",
    "user": "kimchy",
    "postDate": "2009-11-15T13:12:00",
    "message": "Trying out Elastic Search, so far so good?"
  }
}
$

Search API:

$ curl 'http://localhost:9200/twitter/_search?q=user:kimchy' | jq
{
  "took": 13,
  "timed_out": false,
  "_shards": {
    "total": 5,
    "successful": 5,
    "skipped": 0,
    "failed": 0
  },
  "hits": {
    "total": 2,
    "max_score": 0.18232156,
    "hits": [
      {
        "_index": "twitter",
        "_type": "_doc",
        "_id": "oMkQjmgBpfl8Zi7pzJxy",
        "_score": 0.18232156,
        "_source": {
          "type": "tweet",
          "user": "kimchy",
          "postDate": "2009-11-15T13:12:00",
          "message": "Trying out Elastic Search, so far so good?"
        }
      },
      {
        "_index": "twitter",
        "_type": "_doc",
        "_id": "ockRjmgBpfl8Zi7pApyr",
        "_score": 0.18232156,
        "_source": {
          "type": "tweet",
          "user": "kimchy",
          "postDate": "2009-11-15T14:12:12",
          "message": "Another tweet, will it be indexed?"
        }
      }
    ]
  }
}
$ 


list active nodes ("_cat" API for human-readable output):

$ curl 'http://localhost:9200/_cat/nodes?v'
ip        heap.percent ram.percent cpu load_1m load_5m load_15m node.role master name
127.0.0.1           27          98   0    0.00    0.02     0.00 mdi       *      node1
$ 

curl -XGET http://localhost:920<nodeNr>/_cluster/nodes?pretty=true
(same information from each <nodeNr>)

shards overview:

(in this case one node and 5 shard, 1 replica, i.e. 5 shard with one primary and one replica each)

$ curl 'http://localhost:9200/_cat/shards'
twitter 3 p STARTED    1    5kb 127.0.0.1 node1
twitter 3 r UNASSIGNED
twitter 1 p STARTED    1  3.5kb 127.0.0.1 node1
twitter 1 r UNASSIGNED
twitter 2 p STARTED    3 16.5kb 127.0.0.1 node1
twitter 2 r UNASSIGNED
twitter 4 p STARTED    2 10.1kb 127.0.0.1 node1
twitter 4 r UNASSIGNED
twitter 0 p STARTED    0   261b 127.0.0.1 node1
twitter 0 r UNASSIGNED
$


indices:

$ curl 'http://localhost:9200/_cat/indices'
yellow open twitter M9W-t8lyToi202aN7qOp6g 5 1 7 0 30.5kb 30.5kb
$ 


3 shards, 1 replica
===================

node1 started:

  node1: shards 0,1,2


node2 started:

  node1: shards 0,1,2
  node2: shards 0,1,2


node3 started:

  node1: shards 0,2
  node2: shards 1,2
  node3: shards 0,1


node4 started:

  node1: shards 0,2
  node2: shards 2
  node3: shards 0,1
  node4: shards 1


node5 started:

  node1: shards 0,2
  node2: shards 2
  node3: shards 1
  node4: shards 1
  node5: shards 0


node6 started:

  node1: shards 2
  node2: shards 2
  node3: shards 1
  node4: shards 1
  node5: shards 0
  node6: shards 0


node7 started:

  node1..6: no changes
  node7: shards (none)


node7 stopped:

  node1..6: no changes


node4 stopped:

  node1: shards 1,2
  node2: shards 2
  node3: shards 1
  node5: shards 0
  node6: shards 0


node5 stopped:

  node1: shards 1,2
  node2: shards 2
  node3: shards 0,1
  node6: shards 0


node1 stopped:

  node2: shards 1,2
  node3: shards 0,1
  node6: shards 0,2


node3 stopped:

  node2: shards 0,1,2
  node6: shards 0,1,2


node2 stopped:

  node6: shards 0,1,2
